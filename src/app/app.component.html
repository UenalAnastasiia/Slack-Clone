<mat-toolbar>
    <mat-toolbar-row>
        <button *ngIf="!auth" mat-icon-button class="example-icon">
            <mat-icon (click)="sidenav.toggle()">menu</mat-icon>
        </button>
        <mat-icon class="tag-icon">tag</mat-icon>
        <span>Slack-Clone</span>
        <span class="example-spacer"></span>

        <button class="loggedUser-btn" mat-button *ngIf="!auth" [matMenuTriggerFor]="userOptions">
            <img class="userImg-small" src="{{ authService.userImg || 'assets/img/profile.png' }}">
            <span> {{ authService.userName || 'Guest' }} </span>
        </button>
        <mat-menu #userOptions="matMenu">
            <button mat-menu-item (click)="openDialogEditUser()">
                <mat-icon>manage_accounts</mat-icon> Edit User
            </button>
            <button mat-menu-item (click)="logOut()">
                <mat-icon>logout</mat-icon> Logout
            </button>
        </mat-menu>
    </mat-toolbar-row>
</mat-toolbar>

<mat-sidenav-container class="example-container" autosize>
    <mat-sidenav #sidenav class="example-sidenav" mode="side" opened="true" *ngIf="!auth">

        <!-- Channels Block -->
        <mat-nav-list>
            <mat-list-item class="parent color-white" (mouseenter)="showAddBtn()" (mouseleave)="hideAddBtn()">
                <span class="full-width size-22" (click)="showSubmenu = !showSubmenu">Channels</span>
                <mat-icon mat-list-icon class="menu-button" [ngClass]="{'rotated' : showSubmenu}"
                    (click)="showSubmenu = !showSubmenu">
                    expand_more</mat-icon>
                <mat-icon *ngIf="isShowingAddBtn || isShowingAddBtn" class="addChannel-btn"
                    matTooltipClass="example-tooltip-gold" (click)="openDialogAddChannel()">add_circle</mat-icon>
            </mat-list-item>

            <div class="submenu" [ngClass]="{'expanded' : showSubmenu}">
                <a *ngFor="let channel of allChannels | name" mat-list-item
                    routerLink="channel/{{ channel.channelID }}"># {{
                    channel.name }}</a>
                <div class="add-channel-container">
                    <button mat-raised-button (click)="openDialogAddChannel()">
                        <mat-icon>add_circle</mat-icon>
                        <span>Add new Channel</span>
                    </button>
                </div>
            </div>
        </mat-nav-list>

        <!-- Direct Messages Block -->
        <mat-nav-list class="margin-top-28 margin-bottom-28">
            <mat-list-item class="parent color-white" (mouseenter)="showDMbtn()" (mouseleave)="hideDMbtn()">
                <span class="full-width size-22" (click)="showDMmenu = !showDMmenu">Direct Messages</span>
                <mat-icon mat-list-icon class="menu-button" [ngClass]="{'rotated' : showDMmenu}"
                    (click)="showDMmenu = !showDMmenu">
                    expand_more</mat-icon>
                <mat-icon *ngIf="isExpandedDM || isShowingDM" class="addChannel-btn"
                    matTooltipClass="example-tooltip-gold" (click)="openDialogCreateChat()">add_circle</mat-icon>
            </mat-list-item>

            <div class="submenu" [ngClass]="{'expanded' : showDMmenu}">
                <!-- <div *ngFor="let chat of allChats | keyvalue">
                    <a mat-list-item routerLink="chat/{{ chat.id }}"> 
                        {{ chat.secondUser }}</a>
                </div> -->
                <a *ngFor="let chat of allChats" mat-list-item routerLink="chat/{{ chat.id }}"> {{
                    chat.secondUser }}</a>
                <div class="add-channel-container">
                    <button mat-raised-button (click)="openDialogCreateChat()">
                        <mat-icon>add_circle</mat-icon>
                        <span>Write Direct Message</span>
                    </button>
                </div>
            </div>
        </mat-nav-list>
    </mat-sidenav>

    <router-outlet></router-outlet>
</mat-sidenav-container>